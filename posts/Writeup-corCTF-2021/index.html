<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[Writeup] corCTF 2021" /><meta name="author" content="F4c3l3ss_" /><meta property="og:locale" content="en" /><meta name="description" content="fibinary Bài này chúng ta có source code encrypt:" /><meta property="og:description" content="fibinary Bài này chúng ta có source code encrypt:" /><link rel="canonical" href="https://blog.whitebear.vn/posts/Writeup-corCTF-2021/" /><meta property="og:url" content="https://blog.whitebear.vn/posts/Writeup-corCTF-2021/" /><meta property="og:site_name" content="WhiteBearVN" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-23T00:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Writeup] corCTF 2021" /><meta name="twitter:site" content="@WhiteBearVN_" /><meta name="twitter:creator" content="@F4c3l3ss_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"F4c3l3ss_"},"dateModified":"2021-08-23T00:00:00+07:00","datePublished":"2021-08-23T00:00:00+07:00","description":"fibinary Bài này chúng ta có source code encrypt:","headline":"[Writeup] corCTF 2021","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.whitebear.vn/posts/Writeup-corCTF-2021/"},"url":"https://blog.whitebear.vn/posts/Writeup-corCTF-2021/"}</script><title>[Writeup] corCTF 2021 | WhiteBearVN</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="WhiteBearVN"><meta name="application-name" content="WhiteBearVN"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">WhiteBearVN</a></div><div class="site-subtitle font-italic">Thought on cyber security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/WhiteBearVN" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/WhiteBearVN_" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['binhbear.vn','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Writeup] corCTF 2021</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[Writeup] corCTF 2021</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1629651600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 23, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1046 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h2 id="fibinary"><span class="mr-2">fibinary</span><a href="#fibinary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Bài này chúng ta có source code encrypt:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">fib</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
	<span class="n">fib</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">c2f</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
	<span class="n">n</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
	<span class="n">b</span> <span class="o">=</span> <span class="sh">''</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
			<span class="n">n</span> <span class="o">-=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">b</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">b</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span>
	<span class="k">return</span> <span class="n">b</span>

<span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
<span class="n">enc</span> <span class="o">=</span> <span class="sh">''</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
	<span class="n">enc</span> <span class="o">+=</span> <span class="nf">c2f</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.enc</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	<span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">enc</span><span class="p">.</span><span class="nf">strip</span><span class="p">())</span>

<span class="c1">#flag.enc = '10000100100 10010000010 10010001010 10000100100 10010010010 10001000000 10100000000 10000100010 00101010000 10010010000 00101001010 10000101000 10000010010 00101010000 10010000000 10000101000 10000010010 10001000000 00101000100 10000100010 10010000100 00010101010 00101000100 00101000100 00101001010 10000101000 10100000100 00000100100'    
</span></pre></table></code></div></div><p>Thuật toán khá đơn giản đó là chuyển đổi kí tự sang hệ 10 sau đó so sánh với dãy số Finbonanci từ hàm xxx Nếu số hệ 10 của kí tự trong flag bé hơn Finbonanci sẽ là <code class="language-plaintext highlighter-rouge">0</code> và ngược lại là <code class="language-plaintext highlighter-rouge">1</code> cho số lớn hơn, từ đó ta có 1 số binary mới tương ứng với từng kí tự. Đối với bài này ta có thể đảo ngược thuật toán, tuy nhiên có cách nhanh hơn đó là ta tính hết tất cả các kí tự sau đó parse ra theo flag được ban tổ chức đã cho.</p><p>Source code decrypt của mình:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>

<span class="c1">#gen finbonanci 
</span><span class="n">fib</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
	<span class="n">fib</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
<span class="c1">#fib = [1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89]
</span>
<span class="k">def</span> <span class="nf">c2f</span><span class="p">(</span><span class="n">c</span><span class="p">):</span> <span class="c1">#encrypt đổi kí tự thành 11 số binary
</span>	<span class="n">n</span> <span class="o">=</span> <span class="nf">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
	<span class="n">b</span> <span class="o">=</span> <span class="sh">''</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
			<span class="n">n</span> <span class="o">-=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">b</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">b</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span>
	<span class="k">return</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">parsecharacter</span><span class="p">():</span> <span class="c1">#tiềm các số bin tương ứng cho mỗi ký tự đọc được
</span>    <span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">printable</span>
    <span class="n">parse</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
        <span class="n">parse</span><span class="p">[</span><span class="nf">c2f</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span> <span class="o">=</span> <span class="n">c</span>
    <span class="k">return</span> <span class="n">parse</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">():</span>
    <span class="n">flag</span> <span class="o">=</span><span class="sh">''</span>
    <span class="n">cipher</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">10000100100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010000010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010001010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000100100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010010010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10001000000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10100000000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000100010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101010000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010010000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101001010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000101000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000010010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101010000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010000000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000101000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000010010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10001000000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101000100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000100010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10010000100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00010101010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101000100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101000100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00101001010</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10000101000</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">10100000100</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">00000100100</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">:</span>
        <span class="n">flag</span><span class="o">+=</span><span class="nf">str</span><span class="p">(</span><span class="nf">parsecharacter</span><span class="p">().</span><span class="nf">get</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="c1">#lấy kí tự theo cipher qua hàm get của dict
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="nf">decrypt</span><span class="p">()</span>
</pre></table></code></div></div><p>Flag: corctf{b4s3d_4nd_f1bp!113d}</p><h2 id="4096"><span class="mr-2">4096</span><a href="#4096" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">bytes_to_long</span>
<span class="kn">from</span> <span class="n">private</span> <span class="kn">import</span> <span class="n">flag</span>

<span class="k">def</span> <span class="nf">prod</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
		<span class="n">ret</span> <span class="o">*=</span> <span class="n">num</span>
	<span class="k">return</span> <span class="n">ret</span>

<span class="n">m</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="n">primes</span> <span class="o">=</span> <span class="p">[</span><span class="nf">getPrime</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">128</span><span class="p">)]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">prod</span><span class="p">(</span><span class="n">primes</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> 
<span class="nf">print</span><span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="c1">#n=50630448182626893495464810670525602771527685838257974610483435332349728792396826591558947027657819590790590829841808151825744184405725893984330719835572507419517069974612006826542638447886105625739026433810851259760829112944769101557865474935245672310638931107468523492780934936765177674292815155262435831801499197874311121773797041186075024766460977392150443756520782067581277504082923534736776769428755807994035936082391356053079235986552374148782993815118221184577434597115748782910244569004818550079464590913826457003648367784164127206743005342001738754989548942975587267990706541155643222851974488533666334645686774107285018775831028090338485586011974337654011592698463713316522811656340001557779270632991105803230612916547576906583473846558419296181503108603192226769399675726201078322763163049259981181392937623116600712403297821389573627700886912737873588300406211047759637045071918185425658854059386338495534747471846997768166929630988406668430381834420429162324755162023168406793544828390933856260762963763336528787421503582319435368755435181752783296341241853932276334886271511786779019664786845658323166852266264286516275919963650402345264649287569303300048733672208950281055894539145902913252578285197293
#c=pow(m, e, n)=15640629897212089539145769625632189125456455778939633021487666539864477884226491831177051620671080345905237001384943044362508550274499601386018436774667054082051013986880044122234840762034425906802733285008515019104201964058459074727958015931524254616901569333808897189148422139163755426336008738228206905929505993240834181441728434782721945966055987934053102520300610949003828413057299830995512963516437591775582556040505553674525293788223483574494286570201177694289787659662521910225641898762643794474678297891552856073420478752076393386273627970575228665003851968484998550564390747988844710818619836079384152470450659391941581654509659766292902961171668168368723759124230712832393447719252348647172524453163783833358048230752476923663730556409340711188698221222770394308685941050292404627088273158846156984693358388590950279445736394513497524120008211955634017212917792675498853686681402944487402749561864649175474956913910853930952329280207751998559039169086898605565528308806524495500398924972480453453358088625940892246551961178561037313833306804342494449584581485895266308393917067830433039476096285467849735814999851855709235986958845331235439845410800486470278105793922000390078444089105955677711315740050638
</span></pre></table></code></div></div><p>Bài này là một dạng cơ bản của thuật toán RSA. Ta có công thức tính encrypt m là <code class="language-plaintext highlighter-rouge">m^e ≡ c mod n</code>. Để decrypt ta giải theo công thức <code class="language-plaintext highlighter-rouge">c^d ≡ m mod n</code>. Nhưng số <code class="language-plaintext highlighter-rouge">d</code> là gì? <code class="language-plaintext highlighter-rouge">d</code> được tính theo công thức <code class="language-plaintext highlighter-rouge">d*e ≡ 1 (mod λ(n))</code>. Trong đó <code class="language-plaintext highlighter-rouge">λ(n) =(p-1)*(q-1)</code>. Sử dụng sage:</p><p>Với λ(n) = t</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="mi">50630448182626893495464810670525602771527685838257974610483435332349728792396826591558947027657819590790590829841808151825744184405725893984330719835572507419517069974612006826542638447886105625739026433810851259760829112944769101557865474935245672310638931107468523492780934936765177674292815155262435831801499197874311121773797041186075024766460977392150443756520782067581277504082923534736776769428755807994035936082391356053079235986552374148782993815118221184577434597115748782910244569004818550079464590913826457003648367784164127206743005342001738754989548942975587267990706541155643222851974488533666334645686774107285018775831028090338485586011974337654011592698463713316522811656340001557779270632991105803230612916547576906583473846558419296181503108603192226769399675726201078322763163049259981181392937623116600712403297821389573627700886912737873588300406211047759637045071918185425658854059386338495534747471846997768166929630988406668430381834420429162324755162023168406793544828390933856260762963763336528787421503582319435368755435181752783296341241853932276334886271511786779019664786845658323166852266264286516275919963650402345264649287569303300048733672208950281055894539145902913252578285197293</span>
<span class="n">nf</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="mi">2148630611</span> <span class="o">*</span> <span class="mi">2157385673</span> <span class="o">*</span> <span class="mi">2216411683</span> <span class="o">*</span> <span class="mi">2223202649</span> <span class="o">*</span> <span class="mi">2230630973</span> <span class="o">*</span> <span class="mi">2240170147</span> <span class="o">*</span> <span class="mi">2278427881</span> <span class="o">*</span> <span class="mi">2293226687</span> <span class="o">*</span> <span class="mi">2322142411</span> <span class="o">*</span> <span class="mi">2365186141</span> <span class="o">*</span> <span class="mi">2371079143</span> <span class="o">*</span> <span class="mi">2388797093</span> <span class="o">*</span> <span class="mi">2424270803</span> <span class="o">*</span> <span class="mi">2436598001</span> <span class="o">*</span> <span class="mi">2444333767</span> <span class="o">*</span> <span class="mi">2459187103</span> <span class="o">*</span> <span class="mi">2491570349</span> <span class="o">*</span> <span class="mi">2510750149</span> <span class="o">*</span> <span class="mi">2525697263</span> <span class="o">*</span> <span class="mi">2572542211</span> <span class="o">*</span> <span class="mi">2575495753</span> <span class="o">*</span> <span class="mi">2602521199</span> <span class="o">*</span> <span class="mi">2636069911</span> <span class="o">*</span> <span class="mi">2647129697</span> <span class="o">*</span> <span class="mi">2657405087</span> <span class="o">*</span> <span class="mi">2661720221</span> <span class="o">*</span> <span class="mi">2672301743</span> <span class="o">*</span> <span class="mi">2682518317</span> <span class="o">*</span> <span class="mi">2695978183</span> <span class="o">*</span> <span class="mi">2703629041</span> <span class="o">*</span> <span class="mi">2707095227</span> <span class="o">*</span> <span class="mi">2710524571</span> <span class="o">*</span> <span class="mi">2719924183</span> <span class="o">*</span> <span class="mi">2724658201</span> <span class="o">*</span> <span class="mi">2733527227</span> <span class="o">*</span> <span class="mi">2746638019</span> <span class="o">*</span> <span class="mi">2752963847</span> <span class="o">*</span> <span class="mi">2753147143</span> <span class="o">*</span> <span class="mi">2772696307</span> <span class="o">*</span> <span class="mi">2824169389</span> <span class="o">*</span> <span class="mi">2841115943</span> <span class="o">*</span> <span class="mi">2854321391</span> <span class="o">*</span> <span class="mi">2858807113</span> <span class="o">*</span> <span class="mi">2932152359</span> <span class="o">*</span> <span class="mi">2944722127</span> <span class="o">*</span> <span class="mi">2944751701</span> <span class="o">*</span> <span class="mi">2949007619</span> <span class="o">*</span> <span class="mi">2959325459</span> <span class="o">*</span> <span class="mi">2963383867</span> <span class="o">*</span> <span class="mi">3012495907</span> <span class="o">*</span> <span class="mi">3013564231</span> <span class="o">*</span> <span class="mi">3035438359</span> <span class="o">*</span> <span class="mi">3056689019</span> <span class="o">*</span> <span class="mi">3057815377</span> <span class="o">*</span> <span class="mi">3083881387</span> <span class="o">*</span> <span class="mi">3130133681</span> <span class="o">*</span> <span class="mi">3174322859</span> <span class="o">*</span> <span class="mi">3177943303</span> <span class="o">*</span> <span class="mi">3180301633</span> <span class="o">*</span> <span class="mi">3200434847</span> <span class="o">*</span> <span class="mi">3228764447</span> <span class="o">*</span> <span class="mi">3238771411</span> <span class="o">*</span> <span class="mi">3278196319</span> <span class="o">*</span> <span class="mi">3279018511</span> <span class="o">*</span> <span class="mi">3285444073</span> <span class="o">*</span> <span class="mi">3291377941</span> <span class="o">*</span> <span class="mi">3303691121</span> <span class="o">*</span> <span class="mi">3319529377</span> <span class="o">*</span> <span class="mi">3335574511</span> <span class="o">*</span> <span class="mi">3346647649</span> <span class="o">*</span> <span class="mi">3359249393</span> <span class="o">*</span> <span class="mi">3380851417</span> <span class="o">*</span> <span class="mi">3398567593</span> <span class="o">*</span> <span class="mi">3411506629</span> <span class="o">*</span> <span class="mi">3417563069</span> <span class="o">*</span> <span class="mi">3453863503</span> <span class="o">*</span> <span class="mi">3464370241</span> <span class="o">*</span> <span class="mi">3487902133</span> <span class="o">*</span> <span class="mi">3488338697</span> <span class="o">*</span> <span class="mi">3522596999</span> <span class="o">*</span> <span class="mi">3539958743</span> <span class="o">*</span> <span class="mi">3589083991</span> <span class="o">*</span> <span class="mi">3623581037</span> <span class="o">*</span> <span class="mi">3625437121</span> <span class="o">*</span> <span class="mi">3638373857</span> <span class="o">*</span> <span class="mi">3646337561</span> <span class="o">*</span> <span class="mi">3648309311</span> <span class="o">*</span> <span class="mi">3684423151</span> <span class="o">*</span> <span class="mi">3686523713</span> <span class="o">*</span> <span class="mi">3716991893</span> <span class="o">*</span> <span class="mi">3721186793</span> <span class="o">*</span> <span class="mi">3760232953</span> <span class="o">*</span> <span class="mi">3789253133</span> <span class="o">*</span> <span class="mi">3789746923</span> <span class="o">*</span> <span class="mi">3811207403</span> <span class="o">*</span> <span class="mi">3833706949</span> <span class="o">*</span> <span class="mi">3833824031</span> <span class="o">*</span> <span class="mi">3854175641</span> <span class="o">*</span> <span class="mi">3860554891</span> <span class="o">*</span> <span class="mi">3861767519</span> <span class="o">*</span> <span class="mi">3865448239</span> <span class="o">*</span> <span class="mi">3923208001</span> <span class="o">*</span> <span class="mi">3941016503</span> <span class="o">*</span> <span class="mi">3943871257</span> <span class="o">*</span> <span class="mi">3959814431</span> <span class="o">*</span> <span class="mi">3961738709</span> <span class="o">*</span> <span class="mi">3978832967</span> <span class="o">*</span> <span class="mi">3986329331</span> <span class="o">*</span> <span class="mi">3991834969</span> <span class="o">*</span> <span class="mi">3994425601</span> <span class="o">*</span> <span class="mi">4006267823</span> <span class="o">*</span> <span class="mi">4045323871</span> <span class="o">*</span> <span class="mi">4056085883</span> <span class="o">*</span> <span class="mi">4073647147</span> <span class="o">*</span> <span class="mi">4091945483</span> <span class="o">*</span> <span class="mi">4098491081</span> <span class="o">*</span> <span class="mi">4135004413</span> <span class="o">*</span> <span class="mi">4140261491</span> <span class="o">*</span> <span class="mi">4141964923</span> <span class="o">*</span> <span class="mi">4152726959</span> <span class="o">*</span> <span class="mi">4198942673</span> <span class="o">*</span> <span class="mi">4205028467</span> <span class="o">*</span> <span class="mi">4218138251</span> <span class="o">*</span> <span class="mi">4227099257</span> <span class="o">*</span> <span class="mi">4235456317</span> <span class="o">*</span> <span class="mi">4252196909</span> <span class="o">*</span> <span class="mi">4270521797</span> <span class="o">*</span> <span class="mi">4276173893</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2148630611</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2157385673</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2216411683</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2223202649</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2230630973</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2240170147</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2278427881</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2293226687</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2322142411</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2365186141</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2371079143</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2388797093</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2424270803</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2436598001</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2444333767</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2459187103</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2491570349</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2510750149</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2525697263</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2572542211</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2575495753</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2602521199</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2636069911</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2647129697</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2657405087</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2661720221</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2672301743</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2682518317</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2695978183</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2703629041</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2707095227</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2710524571</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2719924183</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2724658201</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2733527227</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2746638019</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2752963847</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2753147143</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2772696307</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2824169389</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2841115943</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2854321391</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2858807113</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2932152359</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2944722127</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2944751701</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2949007619</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2959325459</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">2963383867</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3012495907</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3013564231</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3035438359</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3056689019</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3057815377</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3083881387</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3130133681</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3174322859</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3177943303</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3180301633</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3200434847</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3228764447</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3238771411</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3278196319</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3279018511</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3285444073</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3291377941</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3303691121</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3319529377</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3335574511</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3346647649</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3359249393</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3380851417</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3398567593</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3411506629</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3417563069</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3453863503</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3464370241</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3487902133</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3488338697</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3522596999</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3539958743</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3589083991</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3623581037</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3625437121</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3638373857</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3646337561</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3648309311</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3684423151</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3686523713</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3716991893</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3721186793</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3760232953</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3789253133</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3789746923</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3811207403</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3833706949</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3833824031</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3854175641</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3860554891</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3861767519</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3865448239</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3923208001</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3941016503</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3943871257</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3959814431</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3961738709</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3978832967</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3986329331</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3991834969</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">3994425601</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4006267823</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4045323871</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4056085883</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4073647147</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4091945483</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4098491081</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4135004413</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4140261491</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4141964923</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4152726959</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4198942673</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4205028467</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4218138251</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4227099257</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4235456317</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4252196909</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4270521797</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span>  <span class="p">(</span><span class="mi">4276173893</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Đúng là <code class="language-plaintext highlighter-rouge">λ(n)=(p-1)*(q-1)</code> nhưng vì ở đây chúng ta có quá nhiều p, q nên cứ tiến hành tương tự như vậy; điều này không ảnh hưởng tới bài toán.</p><p>Bây giờ ta tính d:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    d*e ≡ 1 (mod λ(n))
&lt;=&gt; d ≡ 1/e * 1 (mod λ(n))
&lt;=&gt; d ≡ e^(-1) (mod λ(n))
</pre></table></code></div></div><p>Trong python ta có thể tính từ công thức trên theo hàm pow:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">d</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</pre></table></code></div></div><p>Vậy là các biến yêu cầu đã đủ:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
<span class="nf">printf</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
</pre></table></code></div></div><p>Flag: corctf{to0_m4ny_pr1m3s55_63aeea37a6b3b22f}</p><p>Cheer (☞ﾟヮﾟ)☞ ☜(ﾟヮﾟ☜)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/corctf-2021/'>corCTF 2021</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/corctf/" class="post-tag no-text-decoration" >corCTF</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[Writeup]%20corCTF%202021%20-%20WhiteBearVN&url=https%3A%2F%2Fblog.whitebear.vn%2Fposts%2FWriteup-corCTF-2021%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[Writeup]%20corCTF%202021%20-%20WhiteBearVN&u=https%3A%2F%2Fblog.whitebear.vn%2Fposts%2FWriteup-corCTF-2021%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[Writeup]%20corCTF%202021%20-%20WhiteBearVN&url=https%3A%2F%2Fblog.whitebear.vn%2Fposts%2FWriteup-corCTF-2021%2F" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/setup-a-website-with-apache-webserver-and-nginx-waf-reverse-proxy/">Set up website with apache webserver and nginx waf reverse proxy</a><li><a href="/posts/Writeup-VNPT-Secathon-2018/">[Writeup] VPNT Secathon 2018 - Misc</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/asis/">ASIS</a> <a class="post-tag" href="/tags/bsides/">BSides</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Reasearch-Hoc-cryptography-(P.1)/"><div class="card-body"> <em class="small" data-ts="1626541200" data-df="ll" > Jul 18, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Research] Học cryptography (P.1)</h3><div class="text-muted small"><p> Dịch giặc hoành hành, nên mình có thời gian thêm ở nhà làm việc và research một vài thứ mới, hay ho và để bổ sung kiến thức. Mã hóa là một phần của CTF và ATTT; nên mình quyết định học crypto làm c...</p></div></div></a></div><div class="card"> <a href="/posts/Writeup-Dien-tap-ATTT-NHNN-03-2021/"><div class="card-body"> <em class="small" data-ts="1617123600" data-df="ll" > Mar 31, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Writeup] Diễn tập ATTT Ngân hàng Nhà Nước 31/03/2021</h3><div class="text-muted small"><p> 0x01: Ứng cứu sự cố, điều tra số 1. Time2Attack Trong bài này, ban tổ chức (BTC) cung cấp 1 file pcap. Sau khi mở bằng wireshark ta có 1 file zip với tên time.zip. Nhận thấy đây là 1 file zip yêu...</p></div></div></a></div><div class="card"> <a href="/posts/Writeup-BSides-Noida-CTF-2021-Deathnote/"><div class="card-body"> <em class="small" data-ts="1628355600" data-df="ll" > Aug 8, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Writeup] BSides Noida CTF 2021 - Deathnote</h3><div class="text-muted small"><p> Bài này cho chúng ta 1 vuln box trên tryhackme và nhiệm vụ là phải cat được flag trong root folder. Đầu tiên, mình dùng nmap để xem các port đang mở trên box này. $ nmap -vv -sV -sT -sC 10.10.164....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Writeup-BSides-Noida-CTF-2021-Deathnote/" class="btn btn-outline-primary" prompt="Older"><p>[Writeup] BSides Noida CTF 2021 - Deathnote</p></a> <a href="/posts/Writeup-FwordCTF-2021-Forensics/" class="btn btn-outline-primary" prompt="Newer"><p>[Writeup] FwordCTF 2021 - Forensics</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/asis/">ASIS</a> <a class="post-tag" href="/tags/bsides/">BSides</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/WhiteBearVN_">WhiteBearVN</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
